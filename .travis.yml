os: linux
sudo: required
dist: trusty

notifications:
  email: false

language: C++

cache:
  pip: true
  directories:
    - openmpi-2.1.1

before_install:
  - sudo apt-get install gfortran
  - travis_wait bash UnitTests/travis_build_mpi.sh
  - cd openmpi-2.1.1
  - sudo make install >/dev/null 2>&1
  - cd ../
  - sudo ldconfig
  - sudo apt-get install python-dev
  - sudo apt-get install doxygen
  - sudo apt-get install cmake
  - wget https://downloads.sourceforge.net/swig/swig-3.0.12.tar.gz
  - tar xvf swig-3.0.12.tar.gz >/dev/null
  - cd swig-3.0.12
  - ./configure >/dev/null 2>&1
  - make >/dev/null 2>&1
  - sudo make install >/dev/null 2>&1
  - cd ../
  - sudo pip install scipy --upgrade
  - sudo pip install numpy --upgrade
  - sudo pip install mpi4py --upgrade
  - test -n $CC  && unset CC
  - test -n $FCC  && unset FCC
  - test -n $CXX && unset CXX

script:
  - cd Build
  - cmake -DCMAKE_TOOLCHAIN_FILE=../Targets/Linux.cmake ..
  - make
  - make test > test_result.txt
  - tail -n 13 Testing/Temporary/LastTest.log
  - cd ../UnitTests/
  - bash travis_check_examples.sh
